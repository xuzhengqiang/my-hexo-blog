# Hexo 博客部署完整指南

本文档提供两种部署方案：**GitHub Pages** 和 **Vercel**，您可以根据需求选择其中一种或同时使用两种方案。

## 📋 前提条件

- ✅ 已安装 Git
- ✅ 拥有 GitHub 账号
- ✅ 已安装 Node.js (推荐 v16 或更高版本)
- ✅ 代码已提交到本地 Git 仓库

---

## 🎯 方案对比

| 特性 | GitHub Pages | Vercel |
|------|-------------|--------|
| 费用 | 完全免费 | 免费(个人项目) |
| 自动部署 | ✅ 支持 | ✅ 支持 |
| 构建速度 | 较快 | 很快 |
| CDN 加速 | GitHub CDN | 全球 CDN |
| HTTPS | ✅ 自动 | ✅ 自动 |
| 自定义域名 | ✅ 支持 | ✅ 支持 |
| 国内访问速度 | 较慢 | 较快 |
| 配置难度 | 简单 | 非常简单 |

**推荐方案：**
- 🌍 **国际访问为主** → GitHub Pages
- 🇨🇳 **国内访问为主** → Vercel
- 💪 **追求稳定性** → 两者都部署

---

## 🚀 方案一：部署到 GitHub Pages

### 第一步：创建 GitHub 仓库

1. **访问 GitHub**
   - 打开 https://github.com
   - 登录你的账号

2. **创建新仓库**
   - 点击右上角 `+` 号
   - 选择 `New repository`

3. **填写仓库信息**
   - Repository name: `my-hexo-blog` (或任意名称)
   - Description: `My personal blog built with Hexo`
   - 选择 `Public` (公开)
   - **不要**勾选 "Add a README file"
   - 点击 `Create repository`

4. **复制仓库地址**
   - 复制仓库的 HTTPS 地址
   - 格式: `https://github.com/你的用户名/my-hexo-blog.git`

### 第二步：推送代码到 GitHub

在博客目录下打开终端(PowerShell 或 CMD)，执行以下命令：

```bash
# 1. 检查当前 Git 状态
git status

# 2. 添加远程仓库(替换成你的仓库地址)
git remote add origin https://github.com/你的用户名/my-hexo-blog.git

# 3. 推送代码到 master 分支
git push -u origin master
```

**如果遇到身份验证问题：**

- **方法一：使用 Personal Access Token (推荐)**
  1. GitHub → Settings → Developer settings → Personal access tokens → Tokens (classic)
  2. 点击 `Generate new token` → `Generate new token (classic)`
  3. 勾选 `repo` 权限
  4. 设置过期时间(建议选择 90 天或更长)
  5. 点击 `Generate token` 并**立即复制保存**
  6. 推送时使用 token 作为密码

- **方法二：使用 GitHub Desktop (更简单)**
  1. 下载并安装 [GitHub Desktop](https://desktop.github.com/)
  2. 登录 GitHub 账号
  3. 添加本地仓库并推送

### 第三步：配置 GitHub Actions 自动部署

1. **在项目根目录创建 GitHub Actions 配置文件**

创建文件：`.github/workflows/deploy.yml`

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches:
      - master  # 当推送到 master 分支时触发

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout 🛎️
      uses: actions/checkout@v3
      with:
        submodules: true  # 如果主题是 submodule
        fetch-depth: 0    # 获取完整历史
    
    - name: Setup Node.js 📦
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
    
    - name: Install Dependencies 🔧
      run: npm ci
    
    - name: Build 🏗️
      run: npm run build
    
    - name: Deploy 🚀
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: ./public
        publish_branch: gh-pages
        cname: 你的域名.com  # 如果有自定义域名，删除此行则不使用
```

2. **提交并推送配置文件**

```bash
git add .github/workflows/deploy.yml
git commit -m "添加 GitHub Actions 自动部署配置"
git push
```

3. **等待自动部署**
   - 推送后，GitHub Actions 会自动运行
   - 访问仓库的 `Actions` 标签页查看部署进度
   - 首次部署大约需要 2-3 分钟

### 第四步：启用 GitHub Pages

1. **进入仓库设置**
   - 在 GitHub 仓库页面，点击 `Settings`
   - 左侧菜单找到 `Pages`

2. **配置 GitHub Pages**
   - Source: 选择 `Deploy from a branch`
   - Branch: 选择 `gh-pages` 分支，目录选择 `/ (root)`
   - 点击 `Save`

3. **等待部署完成**
   - 几分钟后，页面顶部会显示访问链接
   - 格式: `https://你的用户名.github.io/my-hexo-blog/`

4. **更新 Hexo 配置**

编辑 `_config.yml`，确保 URL 配置正确：

```yaml
url: https://你的用户名.github.io/my-hexo-blog
root: /my-hexo-blog/
```

如果使用自定义域名：

```yaml
url: https://你的域名.com
root: /
```

5. **重新部署**

```bash
git add _config.yml
git commit -m "更新 URL 配置"
git push
```

### GitHub Pages 自定义域名（可选）

1. **在 GitHub 仓库设置中添加域名**
   - Settings → Pages → Custom domain
   - 输入你的域名（如 `blog.example.com`）
   - 点击 `Save`

2. **配置 DNS 记录**

在域名服务商处添加以下记录：

```
类型: CNAME
名称: blog (或 @ 用于根域名)
值: 你的用户名.github.io
```

3. **等待 DNS 生效**
   - 通常需要 10 分钟 - 24 小时
   - GitHub 会自动配置 HTTPS 证书

---

## 🌟 方案二：部署到 Vercel

### 第一步：推送代码到 GitHub

如果还没有推送代码到 GitHub，请先完成上面 **方案一的第一步和第二步**。

### 第二步：在 Vercel 导入项目

#### 方法一：通过 Vercel 网站（推荐，最简单）

1. **访问 Vercel**
   - 打开 https://vercel.com
   - 点击 `Sign Up` 或 `Log In`

2. **使用 GitHub 登录**
   - 选择 `Continue with GitHub`
   - 授权 Vercel 访问你的 GitHub 账号
   - 如果遇到登录问题，尝试使用无痕模式或清除浏览器缓存

3. **导入项目**
   - 点击 `Add New...` → `Project`
   - 在列表中找到你的 `my-hexo-blog` 仓库
   - 点击 `Import`

4. **配置项目（通常自动识别，无需修改）**
   - Project Name: `my-hexo-blog` (可自定义)
   - Framework Preset: `Other` (Vercel 会自动检测)
   - Root Directory: `./` (保持默认)
   - Build Command: `npm run build` (自动填充)
   - Output Directory: `public` (自动填充)
   - Install Command: `npm install` (自动填充)

5. **部署**
   - 点击 `Deploy` 按钮
   - 等待 2-3 分钟，Vercel 会自动构建和部署
   - 可以在部署日志中查看进度

6. **获取访问链接**
   - 部署完成后，会显示你的博客地址
   - 格式: `https://你的项目名.vercel.app`
   - 点击链接访问你的博客！🎉

#### 方法二：通过 Vercel CLI

```bash
# 1. 安装 Vercel CLI
npm install -g vercel

# 2. 登录 Vercel
vercel login

# 3. 部署项目
vercel

# 4. 首次部署会询问：
#    - Set up and deploy? Y
#    - Which scope? 选择你的账号
#    - Link to existing project? N
#    - Project name? my-hexo-blog
#    - In which directory? ./
#    - Want to modify settings? N

# 5. 部署成功后会显示访问链接

# 6. 生产环境部署
vercel --prod
```

### 第三步：配置自动部署

Vercel 已自动配置好自动部署！

每次你推送代码到 GitHub：

```bash
git add .
git commit -m "更新博客内容"
git push
```

Vercel 会自动检测并重新部署博客！🚀

### 第四步：更新 Hexo 配置（重要）

编辑 `_config.yml`，更新 URL 配置：

```yaml
url: https://你的项目名.vercel.app
root: /
```

提交并推送：

```bash
git add _config.yml
git commit -m "更新 Vercel URL 配置"
git push
```

### Vercel 自定义域名（可选）

1. **在 Vercel 中添加域名**
   - 进入项目 → Settings → Domains
   - 输入你的域名（如 `blog.example.com`）
   - 点击 `Add`

2. **配置 DNS**

在域名服务商处添加 DNS 记录：

```
类型: CNAME
名称: blog (或 @ 用于根域名)
值: cname.vercel-dns.com
```

3. **等待生效**
   - DNS 生效通常需要 10 分钟 - 24 小时
   - Vercel 会自动配置 HTTPS 证书

---

## 📝 日常使用

### 写新文章

```bash
# 1. 创建新文章
hexo new "文章标题"

# 2. 编辑文章
# 在 source/_posts/ 找到新创建的 .md 文件并编辑

# 3. 本地预览
hexo clean && hexo server
# 访问 http://localhost:4000 预览

# 4. 提交并推送
git add .
git commit -m "新增文章: 文章标题"
git push

# 5. 自动部署
# GitHub Pages: 2-3 分钟后生效
# Vercel: 1-2 分钟后生效
```

### 创建草稿

```bash
# 创建草稿
hexo new draft "草稿标题"

# 预览草稿（包含草稿的预览）
hexo server --draft

# 发布草稿
hexo publish draft "草稿标题"
```

### 更新主题配置

```bash
# 1. 修改 _config.stun.yml

# 2. 本地测试
hexo clean && hexo server

# 3. 推送更新
git add .
git commit -m "更新主题配置"
git push
```

### 更新站点配置

```bash
# 1. 修改 _config.yml

# 2. 本地测试
hexo clean && hexo server

# 3. 推送更新
git add .
git commit -m "更新站点配置"
git push
```

---

## 🔧 常见问题

### 1. GitHub Actions 构建失败

**检查构建日志：**
- GitHub 仓库 → Actions → 点击失败的工作流 → 查看日志

**常见原因：**
- Node.js 版本不兼容
- 依赖包安装失败
- 主题文件缺失
- 配置文件语法错误

**解决方案：**
```bash
# 本地测试构建
npm run build

# 检查是否生成 public 目录
ls public

# 如果本地能成功，检查 GitHub Actions 配置
# 确保 Node.js 版本与本地一致
```

### 2. Vercel 构建失败

**检查构建日志：**
- Vercel 项目页面 → Deployments → 点击失败的部署 → 查看 Build Logs

**常见原因：**
- Node.js 版本不兼容
- 依赖包安装失败
- 主题文件缺失

**解决方案：**
```bash
# 本地测试构建
npm run build

# 如果本地能成功，则是 Vercel 配置问题
# 在 Vercel 项目设置中指定 Node.js 版本
# Settings → General → Node.js Version → 选择 18.x
```

### 3. 推送到 GitHub 失败

**身份验证错误：**
```bash
# 使用 Personal Access Token
# GitHub → Settings → Developer settings → Personal access tokens
# 创建 token 并使用它作为密码
```

**推送被拒绝：**
```bash
# 先拉取远程更新
git pull origin master --allow-unrelated-histories

# 解决冲突后再推送
git push -u origin master
```

**已存在 origin 远程仓库：**
```bash
# 查看当前远程仓库
git remote -v

# 删除旧的 origin
git remote remove origin

# 添加新的 origin
git remote add origin https://github.com/你的用户名/my-hexo-blog.git
```

### 4. GitHub Pages 显示 404

**原因：**
- 分支或目录配置错误
- URL 配置不正确

**解决方案：**
```yaml
# 检查 _config.yml 中的配置
url: https://你的用户名.github.io/my-hexo-blog
root: /my-hexo-blog/

# 确保 GitHub Pages 设置中：
# Branch: gh-pages
# Directory: / (root)
```

### 5. Vercel 显示 404

**原因：**
- 构建成功但输出目录配置错误

**解决方案：**
```json
// 检查 vercel.json 中 distDir 是否为 public
{
  "version": 2,
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/static-build",
      "config": {
        "distDir": "public"
      }
    }
  ]
}
```

```yaml
# 检查 _config.yml
url: https://你的项目名.vercel.app
root: /
```

### 6. 主题样式不显示

**原因：**
- CSS/JS 文件路径错误
- URL 配置不正确

**解决方案：**
```yaml
# GitHub Pages 部署
url: https://你的用户名.github.io/my-hexo-blog
root: /my-hexo-blog/

# Vercel 部署
url: https://你的项目名.vercel.app
root: /
```

```bash
# 清除缓存并重新生成
hexo clean
hexo generate

# 提交并推送
git add .
git commit -m "修复样式问题"
git push
```

### 7. 图片无法显示

**原因：**
- 图片路径错误
- 图片文件未提交到 Git

**解决方案：**
```markdown
<!-- 使用相对路径 -->
![图片描述](/images/example.jpg)

<!-- 或使用绝对路径 -->
![图片描述](https://你的域名.com/images/example.jpg)
```

```bash
# 确保图片文件已提交
git add source/images/
git commit -m "添加图片资源"
git push
```

### 8. Vercel 登录问题

**问题：**
- 无法登录 Vercel
- 授权后跳转失败

**解决方案：**
1. 使用无痕/隐私模式浏览器
2. 清除浏览器缓存和 Cookie
3. 尝试不同的浏览器（Chrome、Edge、Firefox）
4. 检查是否被防火墙或代理拦截
5. 使用 Vercel CLI 登录：`vercel login`

---

## 📈 性能优化

### 1. 启用 CDN 加速

- **GitHub Pages**: 自动使用 GitHub CDN
- **Vercel**: 自动提供全球 CDN，无需额外配置

### 2. 图片优化

```bash
# 使用图床服务（推荐）
# - 七牛云: https://www.qiniu.com/
# - 阿里云 OSS: https://www.aliyun.com/product/oss
# - 腾讯云 COS: https://cloud.tencent.com/product/cos
# - GitHub + jsDelivr CDN

# 压缩图片
# 使用 TinyPNG: https://tinypng.com/
# 使用 ImageOptim (Mac): https://imageoptim.com/
```

### 3. 启用压缩

Hexo 配置文件中启用 HTML/CSS/JS 压缩：

```bash
# 安装压缩插件
npm install hexo-all-minifier --save
```

在 `_config.yml` 中添加：

```yaml
# 压缩配置
all_minifier: true
```

### 4. 启用缓存

在 `_config.yml` 中配置：

```yaml
# 静态资源版本号
use_cdn: true
```

---

## 🎯 同时部署到两个平台

如果你想同时部署到 GitHub Pages 和 Vercel：

1. **配置 GitHub Actions** (参考方案一)
2. **配置 Vercel** (参考方案二)
3. **使用相同的 GitHub 仓库**

两个平台会独立构建和部署，互不影响。

**优势：**
- ✅ 双重备份，提高可用性
- ✅ 国内外访问都有保障
- ✅ 可以对比两个平台的性能

**配置建议：**
```yaml
# _config.yml 使用通用配置
url: https://你的域名.com  # 使用自定义域名
root: /

# 或者根据主要平台配置
# GitHub Pages 为主
url: https://你的用户名.github.io/my-hexo-blog
root: /my-hexo-blog/

# Vercel 为主
url: https://你的项目名.vercel.app
root: /
```

---

## 🎉 部署完成！

恭喜！你的博客已经成功部署！

### GitHub Pages 优势
- ✅ 完全免费
- ✅ 与 GitHub 深度集成
- ✅ 适合开源项目
- ✅ 稳定可靠

### Vercel 优势
- ✅ 免费托管
- ✅ 自动部署
- ✅ 全球 CDN
- ✅ HTTPS 支持
- ✅ 超快访问速度
- ✅ 国内访问友好

### 现在可以：
1. 📝 开始写作你的第一篇技术文章
2. 🔗 分享你的博客链接给朋友
3. 💼 在简历和社交媒体上展示你的博客
4. 🎨 自定义主题和样式
5. 📊 添加统计和分析工具

---

## 📚 相关资源

### 官方文档
- **Hexo 文档**: https://hexo.io/zh-cn/docs/
- **Stun 主题文档**: https://github.com/liuyib/hexo-theme-stun
- **GitHub Pages 文档**: https://docs.github.com/pages
- **Vercel 文档**: https://vercel.com/docs

### 常用插件
- **SEO 优化**: hexo-generator-sitemap
- **RSS 订阅**: hexo-generator-feed
- **搜索功能**: hexo-generator-search
- **图片懒加载**: hexo-lazyload-image
- **代码压缩**: hexo-all-minifier

### 学习资源
- **Markdown 语法**: https://markdown.com.cn/
- **Git 教程**: https://git-scm.com/book/zh/v2
- **GitHub Actions**: https://docs.github.com/actions

---

## 💡 下一步

1. **写作第一篇文章**
   ```bash
   hexo new "我的第一篇博客"
   ```

2. **自定义主题**
   - 修改 `_config.stun.yml`
   - 调整颜色、字体、布局

3. **添加功能**
   - 评论系统（Gitalk、Valine）
   - 统计分析（Google Analytics、百度统计）
   - 搜索功能（Algolia、本地搜索）

4. **SEO 优化**
   - 提交站点地图到搜索引擎
   - 优化文章标题和描述
   - 添加关键词

**祝你写作愉快！🚀**

